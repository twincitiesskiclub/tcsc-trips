<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Edit Practice Post - TCSC Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/normalize.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles/main.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles/components/_admin.css') }}" />
    <style>
      .practice-post-editor {
        max-width: 800px;
        margin: 0 auto;
      }
      .content-editor textarea {
        width: 100%;
        min-height: 300px;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
      }
      .post-info {
        background: #f5f5f5;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 4px;
        border-left: 4px solid #0066cc;
      }
      .post-actions {
        margin-top: 20px;
        text-align: right;
      }
      .btn {
        padding: 10px 20px;
        margin-left: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
      }
      .btn-primary {
        background: #0066cc;
        color: white;
      }
      .btn-secondary {
        background: #6c757d;
        color: white;
      }
      .btn:hover {
        opacity: 0.9;
      }
      .original-content {
        margin-top: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 4px;
        border-left: 4px solid #28a745;
      }
      .original-content h4 {
        margin-top: 0;
        color: #28a745;
      }
      .original-content pre {
        white-space: pre-wrap;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div class="admin-container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="flash-message {{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      {% if session.user %}
        <div class="user-info">
          Logged in as: {{ session.user.email }}
          <a href="{{ url_for('auth.logout') }}">Logout</a>
        </div>
      {% endif %}

      <div class="practice-post-editor">
        <h1>Edit Practice Post</h1>
        
        <div class="post-info">
          <h3>Practice Date: {{ post.date }}</h3>
          {% if post.id %}
            <p><strong>Announcement ID:</strong> {{ post.id }}</p>
          {% endif %}
          {% if post.slack_message_ts %}
            <p><strong>Slack Message:</strong> Posted to channel {{ post.slack_channel }}</p>
          {% endif %}
          {% if post.posted_at %}
            <p><strong>Posted At:</strong> {{ post.posted_at }}</p>
          {% endif %}
          {% if post.content != post.original_content %}
            <p><strong>Status:</strong> <span style="color: #ff6b00;">Modified</span></p>
          {% else %}
            <p><strong>Status:</strong> <span style="color: #28a745;">Original</span></p>
          {% endif %}
        </div>

        <form method="POST">
          <div class="content-editor">
            <label for="content"><h3>Practice Post Content:</h3></label>
            <textarea 
              id="content" 
              name="content" 
              placeholder="Enter the practice post content..."
              required>{{ post.content }}</textarea>
          </div>

          <div class="post-actions">
            <a href="{{ url_for('admin.get_admin_page') }}" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-primary">Save & Update Slack</button>
          </div>
        </form>

        {% if post.content != post.original_content %}
          <div class="original-content">
            <h4>Original Content:</h4>
            <pre>{{ post.original_content }}</pre>
          </div>
        {% endif %}
      </div>
    </div>
  </body>
</html>